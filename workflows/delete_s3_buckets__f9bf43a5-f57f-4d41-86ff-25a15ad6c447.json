{"id":"f9bf43a5-f57f-4d41-86ff-25a15ad6c447","title":"delete s3 buckets","isDeployed":true,"taskDefaults":{},"lastExecution":null,"description":"","actor":"bc935a57-c7d3-440e-922c-79a22bf7afd6","owner":"bc935a57-c7d3-440e-922c-79a22bf7afd6","ownerType":"USER","isPrivate":true,"triggerType":"Manual","schemaVersion":3,"trigger":{},"modificationInfo":{"createdBy":"bc935a57-c7d3-440e-922c-79a22bf7afd6","createdTime":"2026-01-15T04:09:42.750Z","lastModifiedBy":"bc935a57-c7d3-440e-922c-79a22bf7afd6","lastModifiedTime":"2026-01-15T04:09:42.750Z"},"result":null,"type":"STANDARD","input":{},"hourlyExecutionLimit":1000,"throttle":{"isLimitHit":false,"limitEvents":[]},"workflowLimit":{"isActive":false},"version":1,"unacknowledgedSkippedScheduleAt":null,"tasks":{"get_buckets":{"name":"get_buckets","input":{"script":"// optional import of sdk modules\nimport { execution } from '@dynatrace-sdk/automation-utils';\n\n\nexport default async function ({ executionId }) {\n  const exe = await execution(executionId);\n  const buckets = await exe.result('s3_list_buckets_1');\n  //console.log(buckets.Buckets)\n  const myArray = buckets.Buckets \n  console.log(myArray)\n\n  const deletebuckets = []\n\n  \n  \n  myArray.forEach(function(element, index, array) {\n\n    if (element.Name.includes(\"perform\")) {\n    console.log(element.Name)\n    deletebuckets.push(element.Name);\n    }\n    \n  });\n\n  return  deletebuckets ;\n}"},"action":"dynatrace.automations:run-javascript","active":true,"position":{"x":0,"y":2},"conditions":{"states":{"s3_list_buckets_1":"OK"}},"description":"Run custom JavaScript code.","predecessors":["s3_list_buckets_1"]},"s3_list_buckets_1":{"name":"s3_list_buckets_1","input":{"region":"us-east-1","schema":"builtin:hyperscaler-authentication.connections.aws","MaxBuckets":500,"connection":"vu9U3hXa3q0AAAABADJidWlsdGluOmh5cGVyc2NhbGVyLWF1dGhlbnRpY2F0aW9uLmNvbm5lY3Rpb25zLmF3cwAGdGVuYW50AAZ0ZW5hbnQAJGViYzk3YTE4LTFlZGMtMzRhOC04Yjc1LTlmMzNlMTY2NDYwN77vVN4V2t6t"},"action":"dynatrace.aws.connector:s3-list-buckets","position":{"x":0,"y":1},"description":"This operation is not supported for directory buckets.","predecessors":[]},"s3_delete_bucket_1":{"name":"s3_delete_bucket_1","input":{"Bucket":"{{ _.item }}","region":"us-east-1","schema":"builtin:hyperscaler-authentication.connections.aws","connection":"vu9U3hXa3q0AAAABADJidWlsdGluOmh5cGVyc2NhbGVyLWF1dGhlbnRpY2F0aW9uLmNvbm5lY3Rpb25zLmF3cwAGdGVuYW50AAZ0ZW5hbnQAJGViYzk3YTE4LTFlZGMtMzRhOC04Yjc1LTlmMzNlMTY2NDYwN77vVN4V2t6t"},"action":"dynatrace.aws.connector:s3-delete-bucket","active":true,"position":{"x":0,"y":3},"conditions":{"states":{"get_buckets":"OK"}},"withItems":"item in {{result(\"get_buckets\")}}","concurrency":1,"description":"Deletes the S3 bucket.","predecessors":["get_buckets"]}}}