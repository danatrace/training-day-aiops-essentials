{"id":"e1ef703b-88ac-496a-a4a0-38805fe6e91c","title":"subworkflow - aws resize ec2 instance","isDeployed":true,"taskDefaults":{},"lastExecution":null,"description":"Subworkflow to resize an ec2 instance (Changes the type of instance)\n\nThis subworkflow creates an easy way to trigger\nthe resizing of an aws ec2 instance with\n\nParameters:\n\nresize_to_instance_type: (Required) instance type to resize ec2 instance (for example t3.small, t3.medium etc.)\ninstanceid: (Required) instance id of the ec2 instance to resize \nawsregion: (Required) region in which the ec2 instance to resize resides\ndynatraceawsconnection: (Required) the connection name of the Dynatrace OIDC Connection\n\nThis subworkflow uses the out of the box SSM Document \"AWS-ResizeInstance\" \nhttps://us-east-1.console.aws.amazon.com/systems-manager/documents/AWS-ResizeInstance/description?region=us-east-1\n\nSubworkflow will wait for ssm document execution and will fail if ssm document fails\n\nThe subworkflow sends the command to resize a ec2 stack to the\naws SSM document \"AWS-ResizeInstance\", then waits until\nthe SSM document has finished and then checks if the execution was \nsuccessful. If not, it will fail the subworkflow to provide a restart on error\nfunctionality to the Parent workflow\n\nThis subworkflow Needs subworkflow \"subworkflow - aws wait for systems manager document execution\"","actor":"bc935a57-c7d3-440e-922c-79a22bf7afd6","owner":"bc935a57-c7d3-440e-922c-79a22bf7afd6","ownerType":"USER","isPrivate":false,"triggerType":"Manual","schemaVersion":3,"trigger":{},"modificationInfo":{"createdBy":"bc935a57-c7d3-440e-922c-79a22bf7afd6","createdTime":"2026-01-15T04:09:51.075Z","lastModifiedBy":"bc935a57-c7d3-440e-922c-79a22bf7afd6","lastModifiedTime":"2026-01-15T04:09:51.075Z"},"result":"{{ result(\"wait-for-ssm-execution-completed\") }}","type":"STANDARD","input":{"awsregion":"us-east-1","instanceid":"i-0e831c54dc3f2f0c7","dynatraceawsconnection":"awsplayground","resize_to_instance_type":"t3.small"},"hourlyExecutionLimit":1000,"throttle":{"isLimitHit":false,"limitEvents":[]},"workflowLimit":{"isActive":false},"version":1,"unacknowledgedSkippedScheduleAt":null,"tasks":{"check-status":{"name":"check-status","input":{"script":"// optional import of sdk modules\nimport { execution } from '@dynatrace-sdk/automation-utils';\n\nexport default async function ({ execution_id }) {\n  const configGet = await fetch(`/platform/automation/v1/executions/${execution_id}/tasks/wait-for-ssm-execution-completed/result`);\n  const configBody = await configGet.json();\n  const status = configBody.AutomationExecutionStatus.toUpperCase()\n  console.log(status)\n  \n  if (status !=\"SUCCESS\") {\n        console.log(\"SSM Document Execution has Failed!\");\n        throw new Error(\"SSM Document Execution has Failed!\");\n  } \n\n  return configBody;\n}"},"action":"dynatrace.automations:run-javascript","position":{"x":0,"y":3},"conditions":{"states":{"wait-for-ssm-execution-completed":"OK"}},"description":"Run custom JavaScript code.","predecessors":["wait-for-ssm-execution-completed"]},"wait-for-ssm-execution-completed":{"name":"wait-for-ssm-execution-completed","input":{"workflowId":"20661ec0-29d5-471f-9973-29679d5fe908","workflowInput":"{\n\"AutomationExecutionId\":\"{{result(\"systems_manager_start_automation_execution_1\").AutomationExecutionId }}\",\n\"awsregion\": \"{{ input()[\"awsregion\"] }}\",\n\"dynatraceawsconnection\": \"{{ input()[\"dynatraceawsconnection\"] }}\"\n\n}"},"retry":{"count":99,"delay":60,"failedLoopIterationsOnly":true},"action":"dynatrace.automations:run-workflow","timeout":9999,"position":{"x":0,"y":2},"conditions":{"states":{"systems_manager_start_automation_execution_1":"OK"}},"description":"Modularize your workflows, run any existing workflow.","predecessors":["systems_manager_start_automation_execution_1"]},"systems_manager_start_automation_execution_1":{"name":"systems_manager_start_automation_execution_1","input":{"region":"{{ input()[\"awsregion\"] }}","Parameters":"{ \n  \"InstanceId\": [\"{{ input()[\"instanceid\"] }}\"],\n  \"InstanceType\": [\"{{input()[\"resize_to_instance_type\"] }}\"]\n}","connection":"{% set awsconnection = input()[\"dynatraceawsconnection\"] %}\n{{ connection('builtin:hyperscaler-authentication.connections.aws', awsconnection) }}","DocumentName":"AWS-ResizeInstance"},"retry":{"count":5,"delay":60,"failedLoopIterationsOnly":true},"action":"dynatrace.aws.connector:ssm-start-automation-execution","active":true,"timeout":604800,"position":{"x":0,"y":1},"description":"Initiates execution of an Automation runbook","predecessors":[]}}}