{"id":"20661ec0-29d5-471f-9973-29679d5fe908","title":"subworkflow - aws wait for systems manager  document execution","isDeployed":true,"taskDefaults":{},"lastExecution":null,"description":"Subworkflow to wait for aws ssm document execution to finish\n\nThis subworkflow is used in subworkflows that execute ssm documents\nto wait for the execution to finish and check the status of the execution.\nIf the execution wasnt successful the subworklow will fail so that\nparent workflows can respond with rerun on error.\n\nParameters: \n\nawsregion: (Required) Region in which the SSM document runs\nAutomationExecutionId: (Required) Execution id of the SSM document (Returned by Start SSM actions)\ndynatraceawsconnection: (Required) Dynatrace oidc connection name","actor":"bc935a57-c7d3-440e-922c-79a22bf7afd6","owner":"bc935a57-c7d3-440e-922c-79a22bf7afd6","ownerType":"USER","isPrivate":false,"triggerType":"Manual","schemaVersion":3,"trigger":{},"modificationInfo":{"createdBy":"bc935a57-c7d3-440e-922c-79a22bf7afd6","createdTime":"2026-01-15T04:09:53.509Z","lastModifiedBy":"bc935a57-c7d3-440e-922c-79a22bf7afd6","lastModifiedTime":"2026-01-15T04:09:53.509Z"},"result":"{{ result(\"check-status\").AutomationExecution }}","type":"STANDARD","input":{"awsregion":"us-east-1","AutomationExecutionId":"08093423-3443-4182-8397-12e802518f29","dynatraceawsconnection":"awsplayground"},"hourlyExecutionLimit":1000,"throttle":{"isLimitHit":false,"limitEvents":[]},"workflowLimit":{"isActive":false},"version":1,"unacknowledgedSkippedScheduleAt":null,"tasks":{"get-status":{"name":"get-status","input":{"region":"{{ input()[\"awsregion\"] }}","connection":"{% set awsconnection = input()[\"dynatraceawsconnection\"] %}\n{{ connection('builtin:hyperscaler-authentication.connections.aws', awsconnection) }}","AutomationExecutionId":"{{ input()[\"AutomationExecutionId\"] }}"},"action":"dynatrace.aws.connector:ssm-get-automation-execution","active":true,"position":{"x":0,"y":1},"description":"Get detailed information about a particular Automation execution","predecessors":[]},"check-status":{"name":"check-status","input":{"script":"// optional import of sdk modules\nimport { execution } from '@dynatrace-sdk/automation-utils';\n\nexport default async function ({ execution_id }) {\n  const configGet = await fetch(`/platform/automation/v1/executions/${execution_id}/tasks/get-status/result`);\n  const configBody = await configGet.json();\n  const status = configBody.AutomationExecution.AutomationExecutionStatus.toUpperCase()\n  console.log(status)\n  \n  if (status ==\"INPROGRESS\" || status ==\"PENDING\" ) {\n        console.log(\"Automation still running, restarting again!\");\n        throw new Error(\"Automation still running, restarting again!\");\n  } \n\n  return configBody;\n}"},"action":"dynatrace.automations:run-javascript","active":true,"position":{"x":0,"y":2},"conditions":{"states":{"get-status":"OK"}},"description":"Build a custom task running js Code","predecessors":["get-status"]}}}