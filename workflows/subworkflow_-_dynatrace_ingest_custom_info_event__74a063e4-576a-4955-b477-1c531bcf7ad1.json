{"id":"74a063e4-576a-4955-b477-1c531bcf7ad1","title":"subworkflow - dynatrace ingest custom info event","isDeployed":true,"taskDefaults":{},"lastExecution":null,"description":"Subworkflow to ingest a custom event into dynatrace without needed to know javascript\n\nParameters:\n(Required) Custom Event Json","actor":"bc935a57-c7d3-440e-922c-79a22bf7afd6","owner":"bc935a57-c7d3-440e-922c-79a22bf7afd6","ownerType":"USER","isPrivate":false,"triggerType":"Manual","schemaVersion":3,"trigger":{},"modificationInfo":{"createdBy":"bc935a57-c7d3-440e-922c-79a22bf7afd6","createdTime":"2026-01-15T04:09:57.787Z","lastModifiedBy":"bc935a57-c7d3-440e-922c-79a22bf7afd6","lastModifiedTime":"2026-01-15T04:09:57.787Z"},"result":"{{ result(\"ingest-event\") }}","type":"STANDARD","input":{"title":"start disk cleanup on host","properties":{"workflow":"test","remediation_step":"start disk cleanup","remediation_host_name":"test","remediation_entity_name":"test"},"entitySelector":""},"hourlyExecutionLimit":1000,"throttle":{"isLimitHit":false,"limitEvents":[]},"workflowLimit":{"isActive":false},"version":1,"unacknowledgedSkippedScheduleAt":null,"tasks":{"ingest-event":{"name":"ingest-event","input":{"script":"// optional import of sdk modules\nimport { execution } from '@dynatrace-sdk/automation-utils';\nimport { EventIngest, EventIngestEventType, eventsClient } from '@dynatrace-sdk/client-classic-environment-v2';\nimport { getEnvironmentUrl } from \"@dynatrace-sdk/app-environment\";\n\nexport default async function ({ executionId }) {\n\n  \n  const { input } = await fetch(`/platform/automation/v1/executions/${executionId}`).then((res) => res.json());\n\n  console.log(input.entitySelector)\n\n\n  let final: string | undefined | null;\n  if (input.entitySelector == \"\") {\n      const xevent: EventIngest = {\n        eventType: EventIngestEventType.CustomInfo,\n        title: input.title,\n        properties: input.properties, \n      };\n      console.log(xevent)\n      const result = await eventsClient.createEvent({ body: xevent })\n      while (final  === undefined  || final  === null || final  === \"\") {\n          const data = await eventsClient.getEvents({\n            eventSelector: \"correlationId(\\\"\"+result.eventIngestResults[0].correlationId+\"\\\")\"\n          });\n          final = data.events[0]\n      }\n\n    \n      return final;\n   \n  } else {\n      const xevent: EventIngest = {\n            eventType: EventIngestEventType.CustomInfo,\n            title: input.title,\n            entitySelector: input.entitySelector,\n            properties: input.properties,\n      };\n      console.log(xevent)\n      const result = await eventsClient.createEvent({ body: xevent })\n      while (final  === undefined  || final  === null || final  === \"\") {\n          const data = await eventsClient.getEvents({\n            eventSelector: \"correlationId(\\\"\"+result.eventIngestResults[0].correlationId+\"\\\")\"\n          });\n          final = data.events[0]\n      }\n\n    \n      return final;\n  }\n    \n\n  \n}"},"action":"dynatrace.automations:run-javascript","position":{"x":0,"y":1},"description":"Run custom JavaScript code.","predecessors":[]}}}