{"id":"770b3c17-d17e-4414-9137-58801b275f71","title":"AWS Security create Alert for public S3 Buckets","isDeployed":true,"taskDefaults":{},"lastExecution":{"id":"f02d4b04-b53a-4f5e-9ee3-5946b4ad0e0f","workflow":"770b3c17-d17e-4414-9137-58801b275f71","state":"SUCCESS","stateInfo":null,"input":{"BlockPublicAcls":"true","IgnorePublicAcls":"true","BlockPublicPolicy":"true","RestrictPublicBuckets":"true","dynatraceawsconnection":"554872066791"},"providedInput":{},"params":{},"startedAt":"2026-01-15T04:12:00.046Z","endedAt":"2026-01-15T04:12:03.043Z","runtime":2,"trigger":"Schedule: AWS Security create Alert for public S3 Buckets","schedule":"bee87a70-1aad-4df2-a830-86519fb4265b","eventTrigger":null,"user":null,"actor":"bc935a57-c7d3-440e-922c-79a22bf7afd6","title":"AWS Security create Alert for public S3 Buckets","result":{},"triggerType":"Schedule","workflowVersion":1,"workflowType":"STANDARD","triggerTypeDetail":{"subType":"FIXED_INTERVAL"},"parentExecution":null,"parentTaskName":null,"rootExecution":null,"rootWorkflow":"770b3c17-d17e-4414-9137-58801b275f71","isDraft":false},"description":"Parent workflow to Block Public Access to an S3 Bucket\n\nParameters:\n\ndynatraceawsconnection: (Required) the connection name of the Dynatrace OIDC Connection\nRestrictPublicBuckets: (Optional) Specifies whether Amazon S3 should restrict public bucket policies for this bucket. Setting this element to TRUE restricts access to this bucket to only AWS services and authorized users within this account if the bucket has a public policy\nBlockPublicAcls: (Optional) Specifies whether Amazon S3 should block public access control lists (ACLs) for this bucket and objects in this bucket\nIgnorePublicAcls: (Optional) Specifies whether Amazon S3 should ignore public ACLs for this bucket and objects in this bucket. Setting this element to TRUE causes Amazon S3 to ignore all public ACLs on this bucket and objects in this bucket\nBlockPublicPolicy: (Optional) Specifies whether Amazon S3 should block public bucket policies for this bucket. Setting this element to TRUE causes Amazon S3 to reject calls to PUT Bucket policy if the specified bucket policy allows public access","actor":"bc935a57-c7d3-440e-922c-79a22bf7afd6","owner":"bc935a57-c7d3-440e-922c-79a22bf7afd6","ownerType":"USER","isPrivate":true,"triggerType":"Schedule","schemaVersion":3,"trigger":{"schedule":{"isActive":true,"isFaulty":false,"trigger":{"type":"interval","intervalMinutes":5},"rule":null,"filterParameters":{"earliestStart":"2025-09-19","earliestStartTime":"20:42"},"timezone":"America/Los_Angeles","inputs":{},"nextExecution":"2026-01-15T04:17:00.000Z"}},"modificationInfo":{"createdBy":"bc935a57-c7d3-440e-922c-79a22bf7afd6","createdTime":"2026-01-15T04:09:27.550Z","lastModifiedBy":"bc935a57-c7d3-440e-922c-79a22bf7afd6","lastModifiedTime":"2026-01-15T04:09:27.550Z"},"result":null,"type":"STANDARD","input":{"BlockPublicAcls":"true","IgnorePublicAcls":"true","BlockPublicPolicy":"true","RestrictPublicBuckets":"true","dynatraceawsconnection":"554872066791"},"hourlyExecutionLimit":1000,"throttle":{"isLimitHit":false,"limitEvents":[]},"workflowLimit":{"isActive":false},"version":1,"unacknowledgedSkippedScheduleAt":null,"tasks":{"create-alert":{"name":"create-alert","input":{"workflowId":"9a868582-bf92-4d2c-aea5-90898f7e86b8","workflowInput":"{%set region = _.item.object.configuration.bucketRegion %}\n{%set account = _.item[\"aws.account.id\"] %}\n{\n  \"title\": \"S3 Bucket with Block Public Access set to false detected ({{_.item[\"aws.resource.name\"]}})\",\n  \"dt.smartscape_source.id\": \"{{_.item.id }}\",\n  \"event.description\": \"S3 Bucket with Block Public Access set to false detected\",\n  \"properties\": {\n    \"dt.smartscape_source.id\": \"{{_.item.id }}\",\n    \"aws_region\": \"{{region}}\",\n    \"S3bucket\": \"{{_.item.id }}\",\n    \"S3bucketarn\": \"{{_.item[\"aws.arn\"]}}\",\n    \"S3bucketname\": \"{{_.item[\"aws.resource.name\"]}}\",\n    \"awsaccountid\": \"{{ account }}\"\n}\n}"},"action":"dynatrace.automations:run-workflow","active":true,"position":{"x":0,"y":2},"conditions":{"states":{"get-source-entity":"OK"}},"withItems":"item in {{result(\"get-source-entity\").records}}","concurrency":1,"description":"Modularize your workflows, run any existing workflow.","predecessors":["get-source-entity"]},"get-source-entity":{"name":"get-source-entity","input":{"query":"smartscapeNodes \"AWS_S3_BUCKET\"\n| fieldsAdd name\n| parse aws.object,\"JSON:object\"\n| fieldsadd configuration=object[configuration], supplementary_configuration=object[supplementary_configuration]\n| fieldsadd serverSideEncryptionConfiguration=supplementary_configuration[serverSideEncryptionConfiguration], publicAccessBlockConfiguration=supplementary_configuration[publicAccessBlockConfiguration]\n| fieldsadd publicAccessBlockConfiguration\n| filter publicAccessBlockConfiguration[restrictPublicBuckets] == false\n| filter matchesPhrase(name,\"perform*\") // only for testing remove for go live\n| filter aws.account.id == \"554872066791\" // only for testing remove for go live\n","failOnEmptyResult":false},"retry":{"count":5,"delay":30,"failedLoopIterationsOnly":true},"action":"dynatrace.automations:execute-dql-query","position":{"x":0,"y":1},"conditions":{"states":{}},"description":"Make use of Dynatrace Grail data in your workflow.","predecessors":[]}}}